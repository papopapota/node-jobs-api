# üíº Jobs API

![Node.js](https://img.shields.io/badge/Node.js-v18-green.svg)
![Docker](https://img.shields.io/badge/Docker-Enabled-blue.svg)
![CI/CD](https://img.shields.io/badge/CI%2FCD-GitHub%20Actions-orange.svg)
![AWS](https://img.shields.io/badge/Deployment-AWS%20EC2-yellow.svg)

Una API RESTful robusta para la gesti√≥n de ofertas de trabajo (Jobs). Este proyecto implementa autenticaci√≥n segura, manejo avanzado de errores, documentaci√≥n con Swagger y una infraestructura de despliegue automatizada usando Docker y AWS.

## üöÄ Caracter√≠sticas Principales

### Funcionalidades de Negocio
* **Autenticaci√≥n de Usuarios (JWT):**
    * Registro con validaci√≥n de email y hashing de contrase√±as (bcryptjs).
    * Login con generaci√≥n de tokens JWT.
* **Gesti√≥n de Trabajos (CRUD):** Crear, leer, actualizar y eliminar ofertas de trabajo asociadas a un usuario espec√≠fico.

### Arquitectura y DevOps
* **Containerizaci√≥n:** Docker & Docker Compose.
* **Reverse Proxy:** Nginx configurado como proxy inverso.
* **CI/CD Pipeline:** GitHub Actions automatiza el build, test y despliegue a AWS EC2 al crear nuevos tags (`v*`).
* **Self-Healing:** Implementaci√≥n de Docker Healthchecks para asegurar cero tiempo de inactividad (Zero Downtime Deployments).

### Seguridad Implementada
Este proyecto utiliza un enfoque de defensa en profundidad:
* `helmet`: Headers de seguridad HTTP.
* `cors`: Gesti√≥n de or√≠genes cruzados.
* `xss-clean`: Sanitizaci√≥n de entradas contra ataques XSS.
* `express-rate-limit`: Prevenci√≥n de ataques de fuerza bruta limitando peticiones.

---

## üõ†Ô∏è Stack Tecnol√≥gico

* **Runtime:** Node.js
* **Framework:** Express.js
* **Base de Datos:** MongoDB (Mongoose ODM)
* **Infraestructura:** AWS EC2 (Ubuntu), Docker, Nginx.

---

## ‚öôÔ∏è Instalaci√≥n y Configuraci√≥n Local

### Prerrequisitos
* Node.js & NPM
* Docker (Opcional, si quieres correrlo en contenedor)
* MongoDB URI

### 1. Variables de Entorno
Crea un archivo `.env` en la ra√≠z del proyecto con las siguientes variables:

```bash
MONGO_URI=mongodb+srv://<usuario>:<password>@cluster.mongodb.net/JOBS_API
JWT_SECRET=tu_secreto_super_seguro
JWT_LIFETIME=30d
PORT=3000

### 2. Variables de Entorno
# Instalar dependencias
npm install

# Iniciar servidor
npm start

### 3. Ejecuci√≥n con Docker (Modo Producci√≥n Local)
# Construir y levantar los servicios (API + Nginx)
docker compose up -d


## Estructura del Proyecto
El proyecto sigue una arquitectura MVC (Model-View-Controller) limpia:

/
‚îú‚îÄ‚îÄ controllers/      # L√≥gica de negocio (auth, jobs)
‚îú‚îÄ‚îÄ db/               # Conexi√≥n a Base de Datos (connect.js)
‚îú‚îÄ‚îÄ errors/           # Clases de errores personalizados (BadRequest, NotFound)
‚îú‚îÄ‚îÄ middleware/       # Autenticaci√≥n y Manejo de Errores
‚îú‚îÄ‚îÄ models/           # Schemas de Mongoose (User, Job)
‚îú‚îÄ‚îÄ nginx/            # Configuraci√≥n del Proxy Inverso
‚îú‚îÄ‚îÄ routes/           # Definici√≥n de endpoints
‚îú‚îÄ‚îÄ app.js            # Punto de entrada de la aplicaci√≥n
‚îî‚îÄ‚îÄ docker-compose.yml

## Flujo de CI/CD (GitHub Actions)

El despliegue est√° 100% automatizado para evitar errores humanos:

Versioning: Se utiliza npm version [patch|minor|major] para generar tags.

Build: Usando git push origin main --tags. Al detectar un nuevo tag (v*), GitHub Actions construye la imagen Docker.

Deploy: Se conecta v√≠a SSH a la instancia EC2.

Healthcheck: El despliegue verifica el endpoint /health. Si la API no responde OK, el deploy falla y alerta, evitando subir c√≥digo roto a producci√≥n.


## Documentaci√≥n de la API (Swagger)

La documentaci√≥n interactiva est√° disponible mediante Swagger UI.

Ruta Local: http://localhost:3000/api-docs

Ejemplo de especificaci√≥n YAML:


/jobs/{id}:
  parameters:
    - in: path
      name: id
      schema:
        type: string
      required: true
      description: the job id

## L√≥gica de Validaci√≥n y Modelos
User Model & Auth Flow
El sistema utiliza una validaci√≥n estricta antes de persistir datos:

Validaci√≥n de Email (Regex):
/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
Flujo de Registro:

Validaci√≥n de campos (Mongoose).

Hashing de contrase√±a (pre-save hook).

Generaci√≥n de JWT.

Manejo de Errores Personalizado:

BadRequest: Campos faltantes.

Unauthenticated: Credenciales inv√°lidas.

DuplicateEmail: Error 11000 de Mongoose manejado amigablemente.

CastError: IDs de MongoDB mal formados.